# ArchLinuxInstallation
Установка Arch Linux без графического интерфейса с загрузчиком systemd-boot // Installing Arch Linux without GUI with systemd-boot boot loader

1. Редактирование файла pacman.conf для увеличения количества параллельной загрузки. Открытие файла:

```ruby
nano /etc/pacman.conf
```

Изменение строки `ParallelDownloads = 5` на `ParallelDownloads = 15`. Также по желанию можно раскомментировать строку `#Color`, убрав `#` и после нее добавить строку `ILoveCandy`.
Чтобы сохранить внесенные изменения достаточно воспользоваться сочетанием клавиш "Ctrl + O". Появится вопрос, ка назвать файл для сохранения. Необходимо нажать "Enter" для сохранения предыдущего названия файла.
Чтобы выйти из файла, необходимо воспользоваться сочетанием клавиш "Ctrl + X".

2. Просмотр доступных дисков и выбор диска:

```ruby
fdisk -l
```

или

```ruby
lsblk
```

Необходимо выбрать и запомнить диск в формате `/dev/sdX`, где X - ваша буква диска. Или может быть записано так: `/dev/vdX`.

3. После выбора диска, нужно его разделить на разделы. Есть утилита:

```ruby
cfdisk /dev/sdX
```

Если появится окно с выбором типа диска, то нуобходимо выбрать `gpt`.
Здесь в нижнем меню выбираем `[New]`, перемещаться можно с помощью "Tab" или стрелками влево и вправо.
Вверху меню находится не размеченный диск = `Free space`. Нужно нажать "Enter" и снизу вписать `512M` - это будущий EFI раздел.
Далее стрелками вверх и вниз перемещаемся к `Free space`, нажимаем "Enter" и снизу вписываем значение в 2 раза меньшее количества вашей оперативной памяти, если у вас объем её более 8Gb. Если объем оперативной памяти меньше, то необходимо вписать значение большее вашего объёма на 2Gb. Например, `16G` - это будущий раздел подкачки.
Стрелками вверх и вниз перемещаемся к `Free space`, нажимаем "Enter" и оставшуюся память будем исползовать для основного раздела.
С помощью "Tab" или стрелок вправо и влево нужно выбрать в нижнем меню `[Type]`.
Выбираем `512M`, нажимаем "Enter" и в появившемся окне выбираем `EFI System`.
Выбираем `16G`, нажимаем "Enter" и выбираем `Linux swap`.
Выбираем оставшееся пространство, нажимаем "Enter" и выбираем `Linux filesystem`.
Диск размечен.
Теперь необходимо сохранить все наши изменения, в нижнем меню выбираем `[Write]`, нажимаем "Enter" в появившейся строке нужно согласиться с внесением изменений, написав `yes` и нажав "Enter".
Чтобы выйти, выбираем в нижнем меню `[Quit]` и нажимаем "Enter".

4. Форматирование разделов.
Форматирование EFI раздела для загрузчика (GRUB или Systemd, далее будет расписан вариант для Systemd):

```ruby
mkfs.vfat -F32 /dev/sdX1
```
Форматирование и подготовка раздела подкачки:
```ruby
mkswap /dev/sdX2
swapon /dev/sdX2
```

Форматирование корневого раздела:
```ruby
mkfs.ext4 /dev/sdX3
```
5. Монтирование разделов.
Монтирование основного раздела:

```ruby
mount /dev/sdX3 /mnt
```

Создание директории для записи загрузчика:

```ruby
mkdir -p /mnt/boot
```

Монтирование раздела загрузчика:

```ruby
mount /dev/sdX1 /mnt/boot
```

6. Получение UUID.
С помощью команды:

```ruby
blkid -s UUID -o value /dev/sdX3
```

Выводим на экран UUID. Его необходимо запомнить или записать куда-нибудь, потому что он пригодится при настройке загрузчика.

7. Установка необходимых пакетов (по моему мнению), если хотите установить только систему , то вам хватит первых 6 пакетов

```ruby
pacstrap /mnt base base-devel linux linux-firmware linux-headers nano vim bash-completion ttf-ubuntu-font-family ttf-opensans networkmanager nvidia sudo
```

`pacstrap /mnt` - установит пакеты в корень системы;
`base` - минимальный набор для работы системы, без которого она не запустится;
`base-devel` - интсрумент для сборки пакетов;
`linux` - ядро линукс;
`linux-firmware` - драйверы для оборудования;
`linux-headers` - заголовки ядра дя сборки внешних модулей;
`nano` - простой консольный редактор;
`vim` - мощный редактор;
`bash-completion` - автодополнение команд в bash;
`ttf-ubuntu-font-family`, `ttf-opensans` - шрифты;
`networkmanager` - утилита для управлени сетью;
`nvidia` - проприетарный драйвер для видеокарт nvidia (если amd или intel, то лучше использовать mesa. Если строенная графика intel, то intel-ucode);
`sudo` - позволяет выполнять команды администратора от обычного пользователя.

8. Генерация fstab:

```ruby
genfstab -U /mnt >> /mnt/etc/fstab
```

9. Переход в корень системы:

```ruby
arch-chroot /mnt
```

10. Включение NetworkManager для настройки сети интернет

```ruby
systemctl enable NetworkManager
```

11. Создание пользователя:

```ruby
useradd -m username
```

Вместо username впишите желаемое имя пользователя.

12. Задание пароля.
Зададим пароль пользователю:

```ruby
passwd username
```

И зададим пароль администратору:

```ruby
passwd root
```

13. Дадим права root пользователю (небезопасно).
Откроем файл sudoers:

```ruby
nano /etc/sudoers
```

Необходимо найти строку `root ALL=(ALL:ALL) ALL`. Можно воспользоваться поиском с помощью сочетания клавиш "Ctrl + W".
Ниже этой строки добавляем точно такую же, только вместо `root` должно быть имя вашего пользователя: `username ALL=(ALL:ALL) ALL`.
Также необходимо раскомментировать строку `# %wheel ALL=(ALL:ALL) ALL`. Чтобы раскомментировать, достаточно убрать `#`: `%wheel ALL=(ALL:ALL) ALL`.
Сохраняем файл "Ctrl + O" и выходим "Ctrl + X".

14. Зададим системе доступные языки.
Перехоидм к файлу:

```ruby
nano /etc/locale.gen
```

Ищем строки en_US.UTF-8 UTF-8 и ru_RU.UTF-8 UTF-8 и раскомментируем их.
Сохраняем файл и выходим.

Создадим файл конфигурации и запишем в него язык по умолчанию:

```ruby
echo LANG=ru_RU.UTF-8 > /etc/locale.conf && export LANG=ru_RU.UTF-8
```

Сгенерируем раскомментированные локали:

```ruby
locale-gen
```

Загрузим шрифт стандартного размера с русскими буквами для корректного отображения кириллицы:

```ruby
setfont cyr-sun16
```

15. Зададим имя хосту (ПК):

```ruby
echo arch-pc > /etc/hostname
```

Можете задать любое другое имя вместо `arch-pc`.
Добавим эти данные в файл `hosts`. Откроем файл:

```ruby
nano /etc/hosts
```

В конце файла добавим строку: `127.0.1.1  arch-pc`.
Сохраняем файл и выходим.

16. Создание загрузчика системы.
Установим необходимый пакет:

```ruby
bootctl install
```

Создадим и откроем конфиг-файл нашей системы:

```ruby
nano /boot/loader/entries/arch.conf
```

В него необходимо вписать следующие строки:
`title	Arch Linux`
`linux	/vmlinuz-linux`
`initrd	/initramfs-linux.img`
`options	root=UUID=полученный-ранее-UUID rw`
Сохраняем файл и выходим.

Настроим загрузчик.
Откроем конфиг-файл:

```ruby
nano /boot/loader/loader.conf
```

В него необходимо вписать следующие строки:
`default	arch`
`timeout	10`
`editor	no`
Сохраняем файл и выходим.

Обновим initramfs:

```ruby
mkinitcpio -P
```
17. Почти все готово.
Выходим из системы:

```ruby
exit
```

Размонтируем основной раздел:

```ruby
umount -R /mnt
```

Перезагрузим ПК:

```ruby
reboot
```

Готово! Arch Linux установлен!
